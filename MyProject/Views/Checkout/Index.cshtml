@using System.Data.Entity.Core.Metadata.Edm
@using MyProject.Helper;

@model MyProject.Models.ViewModels.CheckoutViewModel

@{
    ViewBag.Title = "Index";
}

<script src="/Scripts/jquery-1.10.2.min.js"
    type="text/javascript"></script>
<script type="text/javascript">
    $(function () {
        // Document.ready -> link up remove event handler
        $('.paymentType').click(function () {
            $('#paymentType li.selected').text();
        });
    });

    function amountonchangeevent() {
        $('#amountDue').val(@Model.CartTotal - parseFloat($('#amountTextBox').val()).toFixed(2));
    };
</script>

<div class="row">
    <div class="large-12 columns">
        <h3>Payment and Shipping Information</h3>
        <section id="ProfileForm">
            @using (Html.BeginForm("Index", "Checkout", FormMethod.Post, new { @class = "form-horizontal", role = "form", enctype = "multipart/form-data" }))
            {
                @Html.AntiForgeryToken()
                <hr />
                @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                <fieldset>
                    <legend>
                        <h4>Shipping Address</h4>
                    </legend>
                    <div class="form-group">
                        @Html.LabelFor(m => m.ShippingAddress.Line1, new Dictionary<string, Object> { { "class", "col-md-2 control-label" } })
                        <div class="col-md-10">
                            @Html.KTextBoxFor(m => m.ShippingAddress.Line1, new { @class = "fill" })
                            @Html.ValidationMessageFor(m => m.ShippingAddress.Line1, "", new { @class = "text-danger" })
                        </div>
                    </div>
                    <div class="form-group">
                        @Html.LabelFor(m => m.ShippingAddress.Line2, new Dictionary<string, Object> { { "class", "col-md-2 control-label" } })
                        <div class="col-md-10">
                            @Html.KTextBoxFor(m => m.ShippingAddress.Line2, new { @class = "fill" })
                            @Html.ValidationMessageFor(m => m.ShippingAddress.Line2, "", new { @class = "text-danger" })
                        </div>

                    </div>

                    <div class="form-group">
                        @Html.LabelFor(m => m.ShippingAddress.Line3, new Dictionary<string, Object> { { "class", "col-md-2 control-label" } })
                        <div class="col-md-10">
                            @Html.KTextBoxFor(m => m.ShippingAddress.Line3, new { @class = "fill" })
                            @Html.ValidationMessageFor(m => m.ShippingAddress.Line3, "", new { @class = "text-danger" })
                        </div>

                    </div>
                </fieldset>

                <fieldset>
                    <legend>
                        <h4>Payment</h4>
                    </legend>

                    <div class="form-group">
                        @Html.LabelFor(m => m.PaymentTransaction.PaymentType, new Dictionary<string, Object> {{"class", "col-md-2 control-label"}})
                        <select name="paymentType" onchange=" java_script_:show(this.options[this.selectedIndex].value) ">
                            <option value="Cash">Cash</option>
                            <option value="PayPal">PayPal</option>
                        </select>
                    </div>


                    <div class="form-group">
                        @Html.LabelFor(m => m.PaymentTransaction.Amount, new Dictionary<string, Object> {{"class", "col-md-2 control-label"}})
                        <div class="col-md-10">
                            @Html.KTextBoxFor(m => m.PaymentTransaction.Amount, new { id = "amountTextBox", Value= Model.PaymentAmount, @class = "fill" , @onchange = "amountonchangeevent();"  })
                            @Html.ValidationMessageFor(m => m.PaymentTransaction.Amount, "", new {@class = "text-danger"})
                        </div>
                    </div>
                    <b>Amount Due:</b> <span id="amountDue">0.00</span>
                    
                </fieldset>
                
        <p class="button success">
            @Html.ActionLink("Back to Cart","Index", "ShoppingCart", new {}, new {@style="color: #FFFFFF"})
        </p>

        <p class="button success">
            @Html.ActionLink("Checkout", "Index", "Checkout", new {}, new {@style="color: #FFFFFF"})
        </p> 
            }
        </section>
    </div>
</div>

